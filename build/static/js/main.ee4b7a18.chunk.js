(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{20:function(e,t,a){e.exports=a(35)},25:function(e,t,a){},27:function(e,t,a){e.exports=a.p+"static/media/wind.330e5376.svg"},28:function(e,t,a){e.exports=a.p+"static/media/wind_arrow.3096aa4d.svg"},29:function(e,t,a){e.exports=a.p+"static/media/humidity.a6765183.svg"},30:function(e,t,a){e.exports=a.p+"static/media/pressure.e61177a5.svg"},34:function(e,t,a){},35:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(9),o=a.n(c),l=(a(25),a(19)),i=a(8),s=a.n(i),m=a(14),u=a(7);var d=function(e){var t=e.message;return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement("div",{className:"error"},t))};var f=function(e){var t=e.error,a=e.setError,c=e.coordinates,o=e.initApiKey,l=Object(n.useState)(""),i=Object(u.a)(l,2),s=i[0],m=i[1],f=Object(n.useRef)(null);return Object(n.useEffect)((function(){f.current.focus()}),[]),r.a.createElement("div",{className:"api-key__container"},r.a.createElement("div",{className:"api-key"},r.a.createElement("div",{className:"api-key__title"},"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 API-\u043a\u043b\u044e\u0447 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0434\u0430\u043d\u043d\u044b\u043c \u043e \u043f\u043e\u0433\u043e\u0434\u0435 \u043d\u0430 \u0441\u0430\u0439\u0442\u0435 openweathermap.org"),r.a.createElement("form",{className:"api-key__form",onSubmit:function(e){e.preventDefault();var t=s.trim();t?o(c.lat,c.lon,t):a("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043b\u044e\u0447 API!")}},r.a.createElement("input",{ref:f,type:"text",name:"apiKey",placeholder:"API Key",value:s,onChange:function(e){m(e.target.value),a("")}}),r.a.createElement("button",null,"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c")),r.a.createElement("div",{className:"api-key__error"},r.a.createElement(d,{message:t}))))};var p=function(e){var t=e.city;return r.a.createElement("div",{className:"header__info"},r.a.createElement("div",null,"\u041f\u0440\u043e\u0433\u043d\u043e\u0437 \u043f\u043e\u0433\u043e\u0434\u044b"),r.a.createElement("div",{className:"header__city"},t))};var h=function(e){var t=e.weatherMethod,a=e.setError,c=Object(n.useState)(""),o=Object(u.a)(c,2),l=o[0],i=o[1],s=Object(n.useRef)(null);return Object(n.useEffect)((function(){s.current.focus()}),[]),r.a.createElement("form",{className:"header__search",onSubmit:function(e){return function(e){e.preventDefault();var n=l.trim();n?t(n):a("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0433\u043e\u0440\u043e\u0434\u0430!")}(e)}},r.a.createElement("input",{ref:s,type:"text",name:"city",placeholder:"\u0413\u043e\u0440\u043e\u0434",value:l,onChange:function(e){i(e.target.value),a("")}}),r.a.createElement("button",null,"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0433\u043e\u0434\u0443"))},v=function(e,t){var a=new Date(1e3*(e+t)),n=a.getUTCDate(),r=a.getUTCMonth(),c=a.getUTCFullYear();return n+" "+["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"][r]+" "+c},E=function(e,t){var a=new Date(1e3*(e+t)),n=a.getUTCHours(),r=a.getUTCMinutes();return(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)},w=function(e,t){return["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"][new Date(1e3*(e+t)).getUTCDay()]};var y=function(e){return r.a.createElement("div",{className:"today-panel__data"},r.a.createElement("div",{className:"today-panel__row"},r.a.createElement("div",{className:"today-panel__column"},r.a.createElement("div",{className:"today-info"},v(e.weatherInfo.dt,e.timezone_offset)),r.a.createElement("div",{className:"today-info"},E(e.weatherInfo.dt,e.timezone_offset)),r.a.createElement("div",{className:"today-info"},w(e.weatherInfo.dt,e.timezone_offset)))),r.a.createElement("div",{className:"today-panel__row"},r.a.createElement("div",{className:"today-panel__container-main"},r.a.createElement("div",{className:"today-panel__container"},r.a.createElement("div",{className:"temperature"},e.weatherInfo.temp>0?"+":"",e.weatherInfo.temp,"\xb0C")),r.a.createElement("div",{className:"today-panel__container today-img"},r.a.createElement("img",{className:"today-icon",src:"http://openweathermap.org/img/wn/".concat(e.weatherInfo.weather[0].icon,"@4x.png"),alt:e.weatherInfo.weather[0].description})),r.a.createElement("div",{className:"today-panel__column"},r.a.createElement("div",{className:"today-panel__container"},e.weatherInfo.weather[0].description),r.a.createElement("div",{className:"today-panel__container"},"\u043e\u0449\u0443\u0449\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a ",e.weatherInfo.feels_like>0?"+":"",e.weatherInfo.feels_like,"\xb0C")))),r.a.createElement("div",{className:"today-panel__row"},r.a.createElement("div",{className:"today-panel__item"},r.a.createElement("img",{className:"weather-icon",src:a(27),alt:"\u0412\u0435\u0442\u0435\u0440"}),r.a.createElement("span",null," ",e.weatherInfo.wind_speed," \u043c/\u0441"),r.a.createElement("img",{className:"weather-icon",src:a(28),style:{transform:"rotate(".concat(e.weatherInfo.wind_deg+180,"deg)")},alt:"\u041d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0432\u0435\u0442\u0440\u0430"})),r.a.createElement("div",{className:"today-panel__item"},r.a.createElement("img",{className:"weather-icon",src:a(29),alt:"\u0412\u043b\u0430\u0436\u043d\u043e\u0441\u0442\u044c"}),r.a.createElement("span",null,e.weatherInfo.humidity,"%")),r.a.createElement("div",{className:"today-panel__item"},r.a.createElement("img",{className:"weather-icon",src:a(30),alt:"\u0414\u0430\u0432\u043b\u0435\u043d\u0438\u0435"}),r.a.createElement("span",null,Math.round(.75006375541921*e.weatherInfo.pressure)," \u043c\u043c \u0440\u0442 \u0441\u0442"))),r.a.createElement("div",{className:"today-panel__row"},r.a.createElement("div",{className:"today-panel__container"},r.a.createElement("div",{className:"today-panel__item"},"\u0412\u043e\u0441\u0445\u043e\u0434: ",E(e.weatherInfo.sunrise,e.timezone_offset)),r.a.createElement("div",{className:"today-panel__item"},"\u0417\u0430\u043a\u0430\u0442: ",E(e.weatherInfo.sunset,e.timezone_offset)),r.a.createElement("div",{className:"today-panel__item"},"\u041e\u0431\u043b\u0430\u0447\u043d\u043e\u0441\u0442\u044c: ",e.weatherInfo.clouds," %"),r.a.createElement("div",{className:"today-panel__item"},"\u0422\u043e\u0447\u043a\u0430 \u0440\u043e\u0441\u044b: ",e.weatherInfo.dew_point,"\xb0C"),r.a.createElement("div",{className:"today-panel__item"},"UV-\u0438\u043d\u0434\u0435\u043a\u0441: ",e.weatherInfo.uvi," "),r.a.createElement("div",{className:"today-panel__item"},"\u0412\u0438\u0434\u0438\u043c\u043e\u0441\u0442\u044c: ",e.weatherInfo.visibility," \u043c"))))},_=a(4),g=a.n(_),N=a(38),b=a(39),I=a(37),j=a(40),O=(a(31),a(16)),C=a.n(O),k=a(17),x=a.n(k);var z=function(e){var t=e.lat,a=e.lon,c=e.selectNewPlace,o=e.needCityName,l=Object(n.useRef)(null),i=Object(n.useRef)(6);return Object(n.useEffect)((function(){var e=g.a.icon({iconUrl:C.a,shadowUrl:x.a});g.a.Marker.prototype.options.icon=e}),[]),r.a.createElement(N.a,{className:"map",ref:l,center:[t,a],zoom:i.current,maxZoom:18,attributionControl:!0,zoomControl:!0,doubleClickZoom:!1,scrollWheelZoom:!0,dragging:!0,animate:!0,easeLinearity:.35,onDblClick:function(e){i.current=l.current.leafletElement.getZoom(),e&&(o.current=!0,c({lat:e.latlng.lat,lon:e.latlng.lng}))}},r.a.createElement(b.a,{url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png"}),r.a.createElement(I.a,{position:[t,a]},r.a.createElement(j.a,null,t,"\xb0, ",a,"\xb0")))};var D=function(e){var t=e.weatherInfo,a=e.timezone_offset;return r.a.createElement("div",{className:"hourly-panel__item"},r.a.createElement("div",null,v(t.dt,a)," ",E(t.dt,a)),r.a.createElement("div",{className:"sm"},r.a.createElement("img",{src:"http://openweathermap.org/img/wn/".concat(t.weather[0].icon,"@2x.png"),title:t.weather[0].description,alt:t.weather[0].description})),r.a.createElement("div",{className:"xs"},r.a.createElement("img",{src:"http://openweathermap.org/img/wn/".concat(t.weather[0].icon,".png"),title:t.weather[0].description,alt:t.weather[0].description})),r.a.createElement("div",null,t.temp>0?"+":"",t.temp,"\xb0C"))};var S=function(e){var t=e.objectList,a=e.displayedValues,c=e.currentValue,o=e.maxValue,l=e.setCurrentValue,i=Object(n.useRef)(null),s=Object(n.useRef)(null),m=Math.ceil(o/(0===a?1:a)),u=new Array(m).fill("").map((function(e,t){var n="selector";return t*a===c&&(n="selector active"),r.a.createElement("div",{className:n,key:t,onClick:l.bind(null,t*a)})}));return Object(n.useEffect)((function(){0===c?i.current.classList.contains("hide")||i.current.classList.add("hide"):i.current.classList.contains("hide")&&i.current.classList.remove("hide"),c+a===o?s.current.classList.contains("hide")||s.current.classList.add("hide"):s.current.classList.contains("hide")&&s.current.classList.remove("hide")}),[c,a,o]),r.a.createElement("div",{className:"hourly-panel"},r.a.createElement("div",{className:"hourly-panel__container"},r.a.createElement("div",{ref:i,className:"nav nav-backward",onClick:function(){l(c<a?0:function(e){return e-a})}}),r.a.createElement("div",{className:"hourly-panel__row"},t),r.a.createElement("div",{ref:s,className:"nav nav-forward",onClick:function(){l(c+a>o-1?o-a:function(e){return e+a})}})),r.a.createElement("div",{className:"nav-selector"},u))};var L=function(e){var t=e.weatherInfo,a=e.timezone_offset,n=e.countHoursDisplayed,c=e.currentHour,o=e.setCurrentHour,l=Math.min(n,t.length),i=new Array(l).fill("").map((function(e,n){return r.a.createElement(D,{key:c+n,weatherInfo:t[c+n],timezone_offset:a})}));return r.a.createElement(S,{objectList:i,displayedValues:l,currentValue:c,maxValue:t.length,setCurrentValue:o})};var M=function(e){return r.a.createElement("div",{className:"daily-panel__container"},r.a.createElement("div",{className:"daily-panel__item"},r.a.createElement("div",null,w(e.weatherInfo.dt,e.timezone_offset)),r.a.createElement("div",null,v(e.weatherInfo.dt,e.timezone_offset)),r.a.createElement("div",null,r.a.createElement("img",{src:"http://openweathermap.org/img/wn/".concat(e.weatherInfo.weather[0].icon,"@2x.png"),alt:e.weatherInfo.weather[0].description})),r.a.createElement("div",null,"\u0434\u043d\u0451\u043c: ",e.weatherInfo.temp.day>0?"+":"",e.weatherInfo.temp.day,"\xb0C"),r.a.createElement("div",null,"\u043d\u043e\u0447\u044c\u044e: ",e.weatherInfo.temp.night>0?"+":"",e.weatherInfo.temp.night,"\xb0C"),r.a.createElement("div",null,e.weatherInfo.weather[0].description)))};var H=function(e){var t=e.weatherInfo,a=e.timezone_offset,n=e.countDaysDisplayed,c=Math.min(n,t.length),o=new Array(c-1).fill("").map((function(e,n){return r.a.createElement(M,{key:n+1,weatherInfo:t[n+1],timezone_offset:a})}));return r.a.createElement("div",{className:"daily-panel"},o)},U=(a(34),function(e,t){return t?fetch("https://api.openweathermap.org/data/2.5/weather?units=metric&lang=ru&q=".concat(e,"&appid=").concat(t)).then((function(e){return e.json()})).catch((function(e){return{message:"".concat(e.name,": ").concat(e.message)}})):null}),V=function(e,t,a){return a?fetch("https://api.openweathermap.org/data/2.5/weather?units=metric&lang=ru&lat=".concat(e,"&lon=").concat(t,"&appid=").concat(a)).then((function(e){return e.json()})).catch((function(e){return{message:"".concat(e.name,": ").concat(e.message)}})):null},A=function(e,t,a){return a?fetch("https://api.openweathermap.org/data/2.5/onecall?lat=".concat(e,"&lon=").concat(t,"&exclude=minutely&units=metric&lang=ru&appid=").concat(a)).then((function(e){return e.json()})).catch((function(e){return{message:"".concat(e.name,": ").concat(e.message)}})):null};var R=function(){var e=Object(n.useState)(""),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)({lat:55.15,lon:61.43}),i=Object(u.a)(o,2),v=i[0],E=i[1],w=Object(n.useRef)(sessionStorage.getItem("api-key")),_=Object(n.useRef)(!1),g=Object(n.useState)("\u0427\u0435\u043b\u044f\u0431\u0438\u043d\u0441\u043a"),N=Object(u.a)(g,2),b=N[0],I=N[1],j=Object(n.useState)({}),O=Object(u.a)(j,2),C=O[0],k=O[1],x=Object(n.useState)({countDaysDisplayed:5,countHoursDisplayed:3}),D=Object(u.a)(x,2),S=D[0],M=(D[1],Object(n.useState)(0)),R=Object(u.a)(M,2),T=R[0],P=R[1],B=function(){var e=Object(m.a)(s.a.mark((function e(t){var a,n,r,o=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:w.current,n="",e.next=4,U(t,a);case 4:(r=e.sent).message?c("".concat(r.cod?"\u041a\u043e\u0434 \u043e\u0448\u0438\u0431\u043a\u0438: ".concat(r.cod,", "):""," ").concat(r.message," ")):(_.current=!1,r.coord.lat&&r.coord.lon&&r.name?("number"===typeof r.coord.lat&&"number"===typeof r.coord.lat?E({lat:r.coord.lat,lon:r.coord.lon}):n="\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445",I(r.name)):n="\u0414\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b (searchGeographicCoordinatesByCityName)",c(n));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(m.a)(s.a.mark((function e(){var t,a,n,r,o,i=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:v.lat,a=i.length>1&&void 0!==i[1]?i[1]:v.lon,!(n=i.length>2&&void 0!==i[2]?i[2]:w.current)){e.next=22;break}return e.next=6,A(t,a,n);case 6:if(!(r=e.sent)||!r.message){e.next=13;break}return c("".concat(r.cod?"\u041a\u043e\u0434 \u043e\u0448\u0438\u0431\u043a\u0438: ".concat(r.cod,", "):""," ").concat(r.message," ")),k({}),e.abrupt("return",!1);case 13:if(w.current||(w.current=n,sessionStorage.setItem("api-key",n)),c(""),k(Object(l.a)({},r)),!_.current){e.next=21;break}return e.next=19,V(t,a,n);case 19:(o=e.sent).message?c("".concat(o.cod?"\u041a\u043e\u0434 \u043e\u0448\u0438\u0431\u043a\u0438: ".concat(o.cod,", "):""," ").concat(o.message," ")):o.name?I(o.name):c("\u0414\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b (setDataByGeographicCoordinates)");case 21:return e.abrupt("return",!0);case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){w.current&&K(v.lat,v.lon,w.current)}),[]),Object(n.useEffect)((function(){console.log("Coordinates:",v),P(0),K()}),[v.lat,v.lon]),Object(n.useEffect)((function(){K(v.lat,v.lon)}),[T]),r.a.createElement("div",{className:"wrapper"},!w.current&&r.a.createElement(f,{error:a,setError:c,coordinates:v,initApiKey:K}),w.current&&r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"main-panel"},r.a.createElement(d,{message:a}),r.a.createElement("div",{className:"header"},r.a.createElement(p,{city:b}),r.a.createElement(h,{weatherMethod:B,setError:c})),r.a.createElement("div",{className:"current-panel"},C.current&&r.a.createElement("div",{className:"today-panel"},r.a.createElement(y,{weatherInfo:C.current,timezone_offset:C.timezone_offset}),r.a.createElement(z,{lat:v.lat,lon:v.lon,selectNewPlace:E,needCityName:_})),r.a.createElement("div",{className:"bottom_line"}),C.hourly&&r.a.createElement(L,{weatherInfo:C.hourly,timezone_offset:C.timezone_offset,countHoursDisplayed:S.countHoursDisplayed,currentHour:T,setCurrentHour:P}))),C.daily&&r.a.createElement(H,{weatherInfo:C.daily,timezone_offset:C.timezone_offset,countDaysDisplayed:S.countDaysDisplayed})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.ee4b7a18.chunk.js.map